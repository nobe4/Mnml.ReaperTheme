; vim: foldmethod=indent syntax=lisp tabstop=2

; Notes
; tcp_background color, can't set it up using colors+background images.
; needs to be the same, can be 1px because it stretches in directions
; tcp_bg.png        = 1px bgcolor
; tcp_bgsel.png     = slightly lighter than tcp_bg.png
; tcp_idxbg*.png    = remove
; tcp_namebg*.png   = remove
; tcp_iconbg*       = remove
; X = {pan, width*, volume}
; 	tcp_X_knob_small = 1px transparent
; 	tcp_X_knob_stack = all the tcp steps
; 	*: width take the volume stack, no need for tcp_width_knob_stack
; transport_bg.png = 1px bgcolor
; meter

; Documentation

; Global variables
	; Reaper-defined
		version 6.0

		use_pngs 1
		use_overlays 0

		; Don't show borders
		tcp_showborders 0
		mcp_showborders 0
		transport_showborders 0

		; TODO
		tcp_vupeakwidth 5
		mcp_vupeakheight 2
		mcp_mastervupeakheight 4
		mcp_altmeterpos 0
		tcp_vol_zeroline FF666666
		tcp_pan_zeroline 66000000
		mcp_vol_zeroline FF666666
		mcp_pan_zeroline 85000000
		trans_speed_zeroline 85000000
		gen_vol_zeroline FF000000
		gen_pan_zeroline FF000000
		item_volknobfg 85000000 FF778485 00474F4F
		mcp_min_height 240
		mcp_voltext_flags 5 5
		tcp_voltext_flags 12
		tinttcp 298
		peaksedges 0
		no_meter_reclbl 0

		tcp_heights 2 12 20 20   ; TPC heights presets: supercollapsed, collapsed, small(norecarm), recarm size
		envcp_min_height 12

		tcp_folderindent 0 ; control the indent with tcp_folder_indent
		; Envcp min height

		misc_dpi_translate 134 150
		misc_dpi_translate 174 200

	; Font Settings
		; font #1/6/11 - calibri 8
		; font #2/7/12 - calibri 9
		; font #3/8/13 - calibri 10
		; font #4/9/14 - calibri 11

	; Global text colors settings
		; If luminosity of track is too low, switch text to white
		set luma + + * 0.299 [trackcolor_r] * 0.587 [trackcolor_g] * 0.114 [trackcolor_b]
		set track_text_white luma{0}<180 1 0
		; The background color (0001) is basically transparent, but (0000) fails for some reason to be 100% transparent. We can't see it, so that's fine.
		set track_text_color [trackcolor_r trackcolor_g trackcolor_b 245 0 0 0 1]
		; If the track color is too dark, just put white
		set track_text_color ?track_text_white{0} [255 255 255 245 0 0 0 1] .
	
	; Track Control Panel
		set tcp_folder_indent 2                                   ; Px to indent a folder by
		set tcp_folder_width 30                                   ; Folder vertical width
		set tcp_label_width 100                                   ; Label size for each tcp row
		set tcp_meter_lit_color [100 100 100 255]                 ; Lit meter is light grey
		set tcp_meter_readout_color [100 100 100 255 255 0 0 255] ; Top value, always visible, non clipped and clipped.
		set tcp_meter_unlit_color [0]                             ; Unlit meter is transparent
		set tcp_meter_width 19
		set tcp_min_label_width 180                               ; Minimum size for the tcp label
		set tcp_max_button_width 385                              ; Max size for the button section, 20 * 8 + 30 * 4 + 100 + 5 padding
		set tcp_row_height 20                                     ; Height of a TCP row
		set tcp_min_width tcp_row_height                          ; Min width of a row is its height
		set tcp_track_id_width 30                                 ; Width of the track id, enough for 999
	; Envelope Control Panel
		set envcp_button_max_width 155                            ; 3 * 20 + 3 * 30 + 5 padding
		set envcp_value_width 60                                  ; Tuned by eye, roughly enough for max frequence and various effects value.
		set envcp_label_min_width envcp_value_width

; Macro
	; Track Control Panel
		macro compute_tcp
			; Dynamic elements
				; tcp_supercollapsed is whether the parent height is too small for the tcp section
				set tcp_supercollapsed h<10 1 0

			; Default and minimal tcp size
				set tcp.size [300 100 tcp_min_width]

			; Indent
				set tcp_row_indent * tcp_folder_indent folderdepth{0}

			; Folder section.
				set tcp_folder_section_width + + 4 tcp_folder_width * tcp_folder_indent maxfolderdepth
				set tcp_folder_section [tcp_row_indent 0 tcp_folder_section_width h]
				set tcp_folder_compact_button [tcp_folder_section{0} tcp_folder_section{1} 20 20]
				set tcp_folder_modify_button [tcp_folder_section{0} 86 20 14 0 1 0 1]

				; Hide elements if supercollapsed
				set tcp_folder_section ?tcp_supercollapsed{0} [0] .
				set tcp_folder_compact_button ?tcp_supercollapsed{0} [0] .
				set tcp_folder_modify_button ?tcp_supercollapsed{0} [0] .

				set tcp_folder_section_end + tcp_folder_section{0} tcp_folder_section{2}

			; Buttons section
				set tcp_button_section_width - - - w tcp_folder_section{2} tcp_label_width tcp_meter_width
				; Width can't be lower than 0
				set tcp_button_section_width tcp_button_section_width{0}<0 0 .
				; Width can't be above max
				set tcp_button_section_width tcp_button_section_width{0}>tcp_max_button_width{0} tcp_max_button_width .
				set tcp_button_section [tcp_folder_section{2} 0 tcp_button_section_width h]

				; If too small for buttons, hide them
				set tcp_button_section h<20 [0] .

			; Label
				set tcp_label_section_width - - w tcp_button_section_width tcp_meter_width
				set tcp_label_section + [tcp_button_section{2} 0 tcp_label_section_width h] [tcp_folder_section{2}]

			; Meter
				; Meter section is the position/size of the meter: rightmost - tcp width
				set meter_section - [w 0 tcp_meter_width h] [tcp_meter_width]
				; If supercollapsed, hide it.
				set meter_section ?tcp_supercollapsed{0} [0] .

			; First element to build from is the main section
				set previous_element [tcp_button_section]
		endMacro

		macro draw_tcp
			; Track id
				set tcp.trackidx + [0 0 tcp_row_indent] [0 0 tcp_track_id_width 100 0 0 0 1]
				; if collapsed, add to the current track some height to hide the text
				set tcp.trackidx ?tcp_supercollapsed{0} + tcp.trackidx [0 0 0 40]

				; vertical margin for track number
				set tcp.trackidx.margin [tcp_row_indent 0 0 0 0.5 0.5]

				; font
				set tcp.trackidx.font [2]

				; color
				set tcp.trackidx.color track_text_color

			; Folders
				; folder compact button
					set tcp.foldercomp h<40 [0] tcp_folder_compact_button

				; folder button
					; If folder too small, hide modify button
					set tcp.folder h<40 [0] tcp_folder_modify_button

			; Meter view: the meter section wit
				set tcp.meter meter_section  ; set size
				set tcp.meter.vu.div [1] ; show divisions

				; meter text color
					set tcp.meter.readout.color tcp_meter_readout_color
					set tcp.meter.scale.color.unlit.bottom tcp_meter_unlit_color
					set tcp.meter.scale.color.unlit.top tcp_meter_unlit_color
					set tcp.meter.scale.color.lit.bottom tcp_meter_lit_color
					set tcp.meter.scale.color.lit.top tcp_meter_lit_color

			; Buttons
				; Fx
					; Add fx button at its position, fixing width to 20.
					set tcp.fx !fx_group{2} [0] [fx_group fx_group 20 tcp_row_height]

					; Fx bypass button, after fx button, width of 16
					set tcp_fxbyp_x + tcp.fx{0} tcp.fx{2}
					set tcp.fxbyp !fx_group{2} [0] [tcp_fxbyp_x tcp.fx 16 tcp_row_height]

				; Fx input, with padding for button.
					set tcp.fxin !input_group{2} [0] [input_group input_group 29 tcp_row_height]
					; Text item is larger and has reduced width for the button.
					set tcp.recinput - + [tcp.fxin{2}] [tcp.fxin tcp.fxin input_group tcp_row_height] [0 0 tcp.fxin{2}]
					; Margin right 20 is to prevent overlap with the icon.
					set tcp.recinput.margin [0 0 20 0 0.5]
					set tcp.recinput.font [1]

				; Fx and record input, with padding for button

				; Volume
					set tcp.volume [tcp.volume tcp.volume tcp.volume tcp_row_height]
					set tcp.volume.fadermode 1

				; Pan
					set tcp.pan [tcp.pan tcp.pan tcp.pan tcp.pan]
					set tcp.pan.fadermode [1]

				; Width
					set tcp.width [tcp.width tcp.width tcp.width tcp_row_height]
					set tcp.width.fadermode 1

			; Label
				; Default to all space
				set tcp.label tcp_label_section

				; 1px of margin, vertically centered, horizontally left-centerd
				set tcp.label.margin [0 -2 0 0 0 0.5]
				set tcp.label.color track_text_color

			; Fx parameter controls list
				set tcp.fxparm [tcp_button_section main_section_last_visible_element{0} tcp_button_section tcp_button_section]
				set tcp.fxparm.font [1]
				set tcp.fxparm.margin [0]
		endMacro

	; Master Track Panel
		macro compute_master_ctp
			; Main section
				set master_tcp_button_section - w meter_section{2}
				set tcp_button_section [0 0 master_tcp_button_section h]

			; Meter
				set meter_section \
					?tcp_button_section_hidden{0} \
						[0 0 w h] \
						[master_tcp_button_section 0 tcp_meter_width h]

			set tcpNullElement [tcp_button_section]
			set previous_element tcpNullElement
		endMacro

		macro draw_master_tcp
			; Default and Min Size
				set master.tcp.size tcp.size
				set master.tcp.margin [0]

				set master.tcp.meter meter_section
				set master.tcp.meter.vu.div [1]
				set master.tcp.meter.readout.color tcp_meter_readout_color
				set master.tcp.meter.scale.color.unlit.bottom tcp_meter_unlit_color
				set master.tcp.meter.scale.color.unlit.top tcp_meter_unlit_color
				set master.tcp.meter.scale.color.lit.bottom tcp_meter_lit_color
				set master.tcp.meter.scale.color.lit.top tcp_meter_lit_color

			; Label
				set master.tcp.label.color [255 255 255 255]
				set master.tcp.label.font [1]

			; FX
				set master.tcp.fx  !master_fx_group{2} [0] + [0 0 20] [master_fx_group master_fx_group 0 tcp_row_height]
				set master.tcp.fxbyp  !master_fx_group{2} [0] + + [0 0 16] [master.tcp.fx master.tcp.fx 0 tcp_row_height] [master.tcp.fx{2}]
			
			; Volume
				set master.tcp.volume !master.tcp.volume{2} [0 0 0 0] [master.tcp.volume master.tcp.volume master.tcp.volume tcp_row_height]
				set master.tcp.volume.fadermode 1
				set master.tcp.volume.label [0]

			; Pan
				set master.tcp.pan !master.tcp.pan{2} [0 0 0 0] [master.tcp.pan master.tcp.pan tcp_row_height tcp_row_height]
				set master.tcp.pan.fadermode 1
				set master.tcp.pan.label [0]

			; Width
				set master.tcp.width !master.tcp.width{2} [0 0 0 0] [master.tcp.width master.tcp.width master.tcp.width tcp_row_height]
				set master.tcp.width.fadermode 1
				set master.tcp.width.label [0]

			; Fx Param
				set master.tcp.fxparm [tcp_button_section main_section_last_visible_element{0} tcp_button_section tcp_button_section]
				set master.tcp.fxparm.margin [0]
				set master.tcp.fxparm.font [1]
		endMacro

	; Envelope Control Panel
		macro compute_envcp
			set envcp.size tcp.size

		; Buttons section
			set envcp_button_section_width - - w envcp_label_min_width envcp_value_width
			; Width can't be lower than 0
			set envcp_button_section_width envcp_button_section_width{0}<0 0 .
			; Width can't be above max
			set envcp_button_section_width envcp_button_section_width{0}>envcp_button_max_width{0} envcp_button_max_width .
			set envcp_button_section [0 0 envcp_button_section_width h]
			set envcp_button_section h<20 [0] .

		; Label section
			set envcp_label_section_width - - w envcp_button_section_width envcp_value_width
			set envcp_label_section [envcp_button_section{2} 0 envcp_label_section_width h]

		; Value section
			set envcp_value_section - [w 0 envcp_value_width h] [envcp_value_width]

			set previous_element [envcp_button_section]
		endMacro

		macro draw_envcp
			set envcp.margin [0 0 0 0]

			set envcp.label envcp_label_section
			set envcp.label.color [184 184 184]
			set envcp.label.margin [1 0 1 0 0 0.5 0]
			set envcp.label.font [1]

			; Value
				set envcp.value envcp_value_section
				set envcp.value.font [1]
				set envcp.value.color [92 184 169]

				set envcp_value_alignment_width * 2 envcp_value_width
				set envcp_value_horizontal_alignment h>envcp_value_alignment_width{0} 0.5 1
				set envcp.value.margin [0 0 0 0 envcp_value_horizontal_alignment 0.5]

			; Fader
				set envcp.fader.color [54 217 190] ; TODO
				set envcp.fader.fadermode 1
		endMacro

	; Then macro to handle elements one after the other
		macro then element element_width
			; Previous end is the previous element position + width
			set prev_end + previous_element{0} previous_element{2}

			; Place the current element at the previous end, save width and height
			set element [prev_end previous_element element_width tcp_row_height]

			; if hidden, set width to 0
			set element ?hide_##element{0} [. . 0 tcp_row_height]

			; Compute current element rightmost point: it's position + width, minus
			; the main section position.
			set element_rightmost - + element{0} element{2} button_section{0}

			; If collapsed, change the width and height to 0 0
			set element ?tcp_button_section_hidden{0} [. . 0 0]

			; Get top of next row
			set next_row + [0 previous_element{3}] [0 element]

			; If element overflows, move to next row. 5 here is a padding
			; for preventing visual overflow;
			set right_space_left - + element_rightmost{0} 5 button_section{2}
			set element right_space_left{0}>0 [button_section next_row element element]
		
			; Recalculate element_rightmost, now that the element is on a new row
			set element_rightmost - + element{0} element{2} button_section{0}
			set right_space_left - + element_rightmost{0} 5 button_section{2}

			; Remove if still not fitting
			set element right_space_left{0}>0 [. . 0 0]
			
			; Find its bottom: top + height
			set element_bottom + element{1} element{3}

			; Cull if there's not enough height to fit, or if previous_element was culled;
			set element element_bottom{0}>button_section{3} [. . 0 0] .

			; Save reference to previous element
			set previous_element element

			; save reference to main last visible element
			set main_section_last_visible_element element{3}>0 element_bottom{0} .
		endmacro

	; Mixer Control Panel
		macro drawMcp
			clear mcp.*

			; Hide unused elements
				set mcp.fxin [0]
				set mcp.recmode [0]
				set mcp.extmixer.mode [0]
				set mcp.fxlist [0]
				set mcp.fx [0]
				set mcp.fxbyp [0]
				set mcp.io [0]
				set mcp.env [0]
				set mcp.recarm [0]
				set mcp.recmon [0]
				set mcp.recinput [0]

			set mcp_column_width 20
			set mcp_margin_h 5
			set mcp_width + * mcp_column_width 2 * mcp_margin_h 3
			set mcp_label_height 15
			set mcp_label_margin 8

			; Main section
				set mcp.size [mcp_width h]
				set mcp.margin [mcp_margin_h 0 mcp_margin_h 4]

			; Track ID
				set mcp.trackidx [0 0 w mcp_label_height]
				set mcp.trackidx.margin [0 0 0 0 0.5 0.5]
				set mcp.trackidx.color track_text_color

			; Label
				set mcp.label + [0 mcp.trackidx{1} w mcp_label_height] [0 mcp.trackidx{3}]
				set mcp.label.margin mcp.trackidx.margin
				set mcp.label.color mcp.trackidx.color

			; Columns definition
				set mcp_column_section_height - - h * mcp_label_height 2 mcp_label_margin
				set mcp_column_section_x + + mcp.label{1} mcp.label{3} mcp_label_margin
				set mcp_left_column_section [0 mcp_column_section_x mcp_column_width mcp_column_section_height]
				set mcp_right_column_section + + mcp_left_column_section [mcp_margin_h] [mcp_column_width]

			; Left column
				; Meter
					set mcp.meter mcp_left_column_section
					set mcp.meter.vu.div [1]
					set mcp.meter.readout.color tcp_meter_readout_color
					set mcp.meter.scale.color.unlit.bottom tcp_meter_unlit_color
					set mcp.meter.scale.color.unlit.top tcp_meter_unlit_color
					set mcp.meter.scale.color.lit.bottom tcp_meter_lit_color
					set mcp.meter.scale.color.lit.top tcp_meter_lit_color

			; Right column: buttons
				; Volume
					set mcp.volume [mcp_right_column_section{0} mcp_right_column_section{1} 20 20]
					set mcp.volume.label [0]

				; Pan
					set mcp.pan + [mcp_right_column_section{0} mcp.volume{1} 20 20] [0 mcp.volume{3}]
					set mcp.pan.fadermode 1

				; Width
					set mcp.width + [mcp_right_column_section{0} mcp.pan{1} 20 20] [0 mcp.pan{3}]
					set mcp.width.fadermode 1

				; Mute
					set mcp.mute + [mcp_right_column_section{0} mcp.width{1} 20 20] [0 mcp.width{3}]

				; Solo
					set mcp.solo + [mcp_right_column_section{0} mcp.mute{1} 20 20] [0 mcp.mute{3}]

				; Phase
					set mcp.phase + [mcp_right_column_section{0} mcp.solo{1} 20 20] [0 mcp.solo{3}]

				; Folder
					set mcp.folder + + [mcp_right_column_section{0} mcp_right_column_section{1} 20 20] [0 mcp_right_column_section{3}] [0 -20]

		endMacro

	; Create parameters
		macro indexParams desc val min max idx
			define_parameter param##idx desc val min max
		endmacro

; set 10 values to a scalar name
	macro paramPair scalar Idx n1 n2 n3 n4 n5 n6 n7 n8 n9 n10
		set scalar param##Idx<=1 n1 param##Idx==2 n2 param##Idx==3 n3 param##Idx==4 n4 param##Idx==5 n5 param##Idx==6 n6 param##Idx==7 n7 param##Idx==8 n8 param##Idx==9 n9 param##Idx>=10 n10
	endmacro

; Theme variables and parameters
	define_parameter 'defaultV6' 'defaultV6_version' 1

	;           description             val min max idx
	indexParams 'A_mcp_indent'          4   1   7   1
	indexParams 'A_envcp_labelSize'     6   1   7   21
	indexParams 'A_envcp_LabelMeasure'  100 1   200 22
	indexParams 'A_envcp_fader_size'    1   1   7   23
	indexParams 'A_envcp_folder_indent' 1   0   1   24
	indexParams 'A_mcp_Sidebar'         0   1   5   25
	indexParams 'A_mcp_Narrow'          0   1   5   26
	indexParams 'A_mcp_Meter_Expansion' 3   1   5   27
	indexParams 'A_mcp_Labels'          3   1   5   28
	indexParams 'A_mcp_meterExpSize'    3   1   4   29
	indexParams 'A_mcp_border'          1   1   5   30

	indexParams 'A_trans_rate_size'     1   1   7   77
	indexParams 'A_mcp_control_align'   2   1   2   78
	indexParams 'A_tcp_control_align'   1   1   2   79

; global color and other custom parameters
	def gl_pan_color     trackpanmode<=5 [0 0 0 120]       [84 63 63]
	def gl_width_color   trackpanmode=5  [255 255 255 210] [63 84 63]
	; Switch swaper ?
	def gl_fader_swap    trackpanmode==6 [0]               [1]

; Track control panels
	clear tcp.*

	; z-index
	front tcp.label tcp.meter
	compute_tcp

	set button_section tcp_button_section
	; Element ordering in the tcp
		;    element     size
		then tcp.recarm  20
		then tcp.recmon  20
		then tcp.volume  20
		then tcp.pan     20
		then tcp.width   20
		then tcp.mute    20
		then tcp.solo    20
		then tcp.phase   20
		then tcp.io      30
		then fx_group    30
		then tcp.env     30
		then tcp.recmode 30
		then input_group 100

	; Draw the layout
	draw_tcp

	; Custom layouts
	;;Layout "A"

		;;	compute_tcp_sections

		;;	then tcp.recarm  20            0
		;;	then tcp.recmon  15            0
		;;	then tcp.label   tcp_label_width 0
		;;	then pan_group   tcp_PanSize   1
		;;	then fx_group    36            1
		;;	then tcp.io      34            1
		;;	then tcp.env     41            1
		;;	then tcp.recmode 39            1

		;;	set tcp.label  .
		;; draw_tcp
		;;EndLayout

; Master Track Control Panel
	compute_master_ctp

	;      element           size
		then master.tcp.label  50
		then master.tcp.volume 20
		then master.tcp.pan    20
		then master.tcp.width  20
		then master.tcp.mono   20
		then master.tcp.solo   20
		then master.tcp.mute   20
		then master.tcp.io     30
		then master_fx_group   30
		then master.tcp.env    30

	draw_master_tcp

; Envelope Control Panels
	paramPair 	EnvcpLabelSize 					21 0 20 50 80 110 140 170
	paramPair 	EnvcpVolSize 					23 20 40 70 100 130 160 190

	set EnvLabelAutoMeasured 					param22

	clear envcp.*

	front envcp.fader

	compute_envcp

	set button_section envcp_button_section

	; element size
	then envcp.arm    20
	then envcp.bypass 20
	then envcp.fader  20
	then envcp.mod    30
	then envcp.learn  30
	then envcp.hide   30

	draw_envcp

; Mixer
	macro doModeLogic variable paramIdx
		set variable param##paramIdx##&1 ?track_selected 1 0
		set variable param##paramIdx##&2 !track_selected 1 variable
		set variable param##paramIdx##&4 ?recarm 1 variable
		set variable param##paramIdx##&8 !recarm 1 variable
	endmacro


	set hide_inputFX				[400] 	; height below which input effects is hidden.
	set hide_input              	[350] 	; height below which input dropdown is hidden.
	set hide_pan_labels          	[320] 	; height below which pan labels are hidden.
	set hide_pan					[260] 	; height below which pan controls are hidden.
	set hide_volume_label        	[250] 	; height below which volume label is hidden.
	set extmixer_w					[86] 	; width of the extmixer when set as a sidebar

	; sidebar (pushes other secs right)
	; fx section (background is baked into mcp_bg)
	; pan section
	; input section (show/hide inputFX on resize / recarm, with user override)
	; stretch section (recarm pokes above)

	set mcp_control_align 1

	doModeLogic sidebarMode 	25
	doModeLogic narrowMode 		26
	doModeLogic meterExpMode 	27
	doModeLogic labelsMode 		28
	paramPair mcp_meterExp 		29 0 2 4 8
	paramPair mcp_border 		30 0 1 2 3 4
	drawMcp 1

; Master Mixer
	  ; --------------- User adjustable values. Edit without fear. -----------------

	set hide_inputFX				[400] ; height below which input effects is hidden.
	set hide_pan_labels          	[320] ; height below which pan labels are hidden.
	set hide_pan					[260] ; height below which pan controls are hidden.
	set hide_volume_label        	[200] ; height below which volume label is hidden.

	  ; ------- End of user adjustable values. From here on may be dragons. ---------

	macro drawMasterMcp
		clear master.mcp.*
		front                							master.mcp.menubutton master.mcp.io master.mcp.env master.mcp.mute master.mcp.solo
		set master.mcp.size         					+ [125 370] [0 0 0 mcp.size]
		set hide_pan_sm 							 hide_pan
		set hide_pan_labels_sm						 hide_pan_labels
		set fx_sec								 		+ [0 0 master.mcp.size{0}] [0 0 0 27]
		set pan_sec 						     		+ [0 fx_sec{3} master.mcp.size{0}] h<hide_pan_labels_sm{0} h<hide_pan_sm{0} [0 0 0 6] [0 0 0 28] [0 0 0 48]
		set bot_sec								 		+ [0 h master.mcp.size{0}] [0 -23 0 23]
		set stretch_sec_start					 		+ fx_sec{3} pan_sec{3}
		set stretch_sec_height					 		- - - h fx_sec{3} pan_sec{3} bot_sec{3}
		set stretch_sec 						 		[0 stretch_sec_start{0} master.mcp.size{0} stretch_sec_height{0}]
		set padding_reduction_h						 [300 200]
		set padding 							 	 stretch_sec_height{0}<padding_reduction_h{0} stretch_sec_height{0}<padding_reduction_h{1} [0 2] [0 3] [0 4]
		set master.mcp.fx                               [7 7 82 20]
		set master.mcp.fxbyp                            [89 7 29 20]
		set master.mcp.pan   							+ [0 pan_sec] h<hide_pan_sm{0} [0]  	trackpanmode==6 	h<hide_pan_labels_sm{0} [7 5 67 9] [7 15 67 9] \
																									trackpanmode>=4		h<hide_pan_labels_sm{0} [20 4 20 20] [20 7 20 20] \
																														h<hide_pan_labels_sm{0} [31 4 20 20] [31 7 20 20]
		  set master.mcp.pan.fadermode              	gl_fader_swap
		  set master.mcp.pan.color                  	gl_pan_color
		  set master.mcp.pan.label                  	h<hide_pan_labels_sm{x} [0] + [0 master.mcp.pan] trackpanmode>=4 trackpanmode==6 [23 -11 35 9] [6 25 35 10] [23 25 35 10]
		  set master.mcp.pan.label.color				[140 140 140]
		  set master.mcp.pan.label.margin           	[0 0 0 0 0.5]
		  set master.mcp.pan.label.font					[1]
		set master.mcp.width  							+ [0 pan_sec] h<hide_pan_sm{0} [0]  	trackpanmode==6 	h<hide_pan_labels_sm{0} [7 13 67 9] [7 23 67 9] \
																									trackpanmode>=4		h<hide_pan_labels_sm{0} [48 4 20 20] [48 7 20 20] [0]
		  set master.mcp.width.fadermode            	gl_fader_swap
		  set master.mcp.width.color                	gl_width_color
		  set master.mcp.width.label                	h<hide_pan_labels_sm{x} [0] + [0 master.mcp.width] trackpanmode>=4 trackpanmode==6 [23 11 35 9] [41 25 35 10] [0]
		  set master.mcp.width.label.color				[140 140 140]
		  set master.mcp.width.label.margin         	[0 0 0 0 0.5]
		  set master.mcp.width.label.font				[1]
		set master.mcp.mono                             + [0 pan_sec] h<hide_pan_labels_sm{0} h<hide_pan_sm{0} [0] [93 4 25 22] [93 8 25 33]
		set master.mcp.volume.label                     h<hide_volume_label{0} [0 0 0 0] + [0 stretch_sec] [1 0 89 23]
		  set master.mcp.volume                         - + + [69 0 21] [0 stretch_sec 0 stretch_sec] [0 master.mcp.volume.label{3}] [0 0 0 master.mcp.volume.label{3}]
		  set master.mcp.volume.label.color             master.mcp.volume.label{h}>2 [100 100 100] [38 38 38]
		  set master.mcp.volume.label.margin            + [0 0 0 0 0.5] [0 4]
		  set master.mcp.volume.label.font				[1]
		set master.mcp.meter                            + [0 master.mcp.volume 0 master.mcp.volume] [4 0 59 -6]
		  set master.mcp.meter.vu.div                   [1]
		  set master.mcp.meter.vu.rmsdiv                [2]
		  set master.mcp.meter.readout.color            [255 255 255 200 0 0 0 0]
		  set master.mcp.meter.rmsreadout.color         [255 255 255 255 0 0 0 0]
		  set master.mcp.meter.scale.color.lit.bottom   [0 0 0 200 0 0 0 0]
		  set master.mcp.meter.scale.color.lit.top      [0 0 0 200 0 0 0 0]
		  set master.mcp.meter.scale.color.unlit.bottom [255 255 255 120 0 0 0 0]
		  set master.mcp.meter.scale.color.unlit.top    [255 255 255 120 0 0 0 0]
		set master.mcp.label                            bot_sec
		  set master.mcp.label.color                    [184 184 184]
		  set master.mcp.label.margin                   + [20 1] [0 0 0 0 0.5]
		  set master.mcp.label.font						[3]
		set master.mcp.mute                             + [0 stretch_sec] [95 6 21 20]
		set master.mcp.solo                             + + [0 padding] [master.mcp.mute master.mcp.mute] [0 21 21 20]
		set master_mcp_env_hide_h					 141
		set master.mcp.env                              stretch_sec_height{0}<master_mcp_env_hide_h{0} [0] + + [0 stretch_sec] [0 stretch_sec{3}] [95 -37 21 30]
		set master_mcp_io_hide_h					 106
		set master.mcp.io                               stretch_sec_height{0}<master_mcp_io_hide_h{0} [0] + + [0 padding] [master.mcp.solo master.mcp.solo] [0 23 23 30]
		set master.mcp.menubutton                       + [0 2 20 20] [bot_sec bot_sec]
		set master.mcp.extmixer.mode                    [0]
			set master.mcp.fxlist.font                  [1 16]
			set master.mcp.fxlist.margin                mcp.fxlist.margin 
			set master.mcp.sendlist.font                [1 16]
			set master.mcp.sendlist.margin              mcp.sendlist.margin
			set master.mcp.fxparm.font                  [1 24 0 0 -1]
			set master.mcp.fxparm.margin                mcp.fxparm.margin
	endmacro
	drawMasterMcp

; Transport

; Hide some buttons
set trans.automode [0] ; automation mode
set trans.pause [0]    ; pause
set trans.stop [0]     ; stop
set trans.fwd [0]      ; go to end of project

;set trans.rate [0 0 200 h]
set trans.rate.fader.fadermode [1]

; To comment
	;[color theme]
	; Colors are decimal
	;col_mi_label=16711680
	;col_mi_label_sel=16711680
	;col_mi_label_float=16711680
	;col_mi_label_float_sel=16711680
	;col_mi_bg2=16711680
	;col_mi_bg=16711680
	;col_mi_fades=16711680
	;col_mi_fade2=16711680
	;col_tl_fg=7631988
	;col_tl_bg=3355443
	;col_tl_bgsel=16777215
	;col_tl_bgsel2=8947842
	;col_env1=8444928
	;col_env2=4227136
	;col_env3=255
	;col_env4=38655
	;col_env5=0
	;col_env6=16776960
	;col_env7=128
	;col_env8=8421376
	;col_env9=12615680
	;col_env10=16384
	;col_env11=16776960
	;col_env12=65535
	;col_env13=16711808
	;col_env14=8421440
	;col_env15=16711680
	;col_env16=8388863
	;col_tr1_bg=4342338
	;col_tr2_bg=4539717
	;col_tr1_itembgsel=11842737
	;col_tr2_itembgsel=11842737
	;col_offlinetext=4670000
	;col_seltrack=9013633
	;col_seltrack2=-2138470015
	;col_cursor=8886323
	;col_cursor2=8886323
	;col_gridlines=0
	;col_gridlines2=0
	;col_gridlines3=0
	;marker=160
	;region=7500374
	;col_tr1_peaks=1710618
	;col_tr2_peaks=1644825
	;col_tr1_ps2=-11316397
	;col_tr2_ps2=5460819
	;col_peaksedge=3881787
	;col_peaksedge2=3881787
	;col_peaksedgesel=14803425
	;col_peaksedgesel2=14803425
	;item_grouphl=3192883
	;col_main_bg=-2135838293
	;col_tcp_text=1907218
	;col_tcp_textsel=1907218
	;col_main_text=2236958
	;col_main_textshadow=3355443
	;col_main_3dhl=3355443
	;col_main_3dsh=3355443
	;col_main_editbk=14737630
	;col_tsigmark=1118734
	;col_vudoint=0
	;col_vubot=12566272
	;col_vumid=11393536
	;col_vutop=9829888
	;col_vuclip=9659
	;col_vuintcol=2105376
	;col_vumidi=50431
	;col_buttonbg=0
	;col_fadearm=3936710
	;col_fadearm2=8890385
	;col_fadearm3=1143208
	;col_mixerbg=3355443
	;col_tracklistbg=3355443
	;midi_rulerbg=4473924
	;midi_rulerfg=10132122
	;midi_grid1=0
	;midi_grid2=16777215
	;midi_grid3=0
	;midi_trackbg1=4605510
	;midi_trackbg2=4079166
	;midi_inline_trackbg1=4605510
	;midi_inline_trackbg2=4079166
	;midioct=3026478
	;midioct_inline=3026478
	;midi_endpt=10075411
	;midi_notebg=0
	;midi_notefg=16777215
	;midi_notemute=128
	;midi_notemute_sel=255
	;midi_itemctl=0
	;midi_editcurs=8886323
	;midi_ofsn=4802889
	;midi_ofsnsel=10075411
	;midi_pkey1=16777215
	;midi_pkey2=0
	;midi_pkey3=6118749
	;docker_shadow=3355443
	;docker_selface=9013633
	;docker_unselface=2763306
	;docker_text=9013633
	;docker_bg=3947580
	;mcp_fx_normal=12566463
	;mcp_fx_bypassed=4295379
	;mcp_fx_offlined=4013528
	;mcp_sends_normal=12566463
	;mcp_sends_muted=4013528
	;mcp_sends_levels=4670000
	;env_track_mute=192
	;env_sends_mute=49344
	;env_item_vol=128
	;env_item_pan=8421376
	;env_item_mute=49344
	;marquee_fill=7241856
	;marquee_outline=16777215
	;marquee_drawmode=170495
	;timesel_drawmode=135424
	;itembg_drawmode=196608
	;fadezone_drawmode=140800
	;playcursor_drawmode=163840
	;fadezone_color=72
	;playcursor_color=5425391
	;region_lane_bg=3355443
	;marker_lane_bg=3947580
	;ts_lane_bg=3355443
	;region_lane_text=12895417
	;marker_lane_text=10790052
	;ts_lane_text=10855845
	;group_0=255
	;group_1=65280
	;group_2=16711680
	;group_3=65535
	;group_4=16711935
	;group_5=16776960
	;group_6=192
	;group_7=49152
	;group_8=12582912
	;group_9=49344
	;group_10=12583104
	;group_11=12632064
	;group_12=128
	;group_13=32768
	;group_14=8388608
	;group_15=32896
	;group_16=8388736
	;group_17=8421376
	;group_18=32960
	;group_19=8437760
	;group_20=12615680
	;group_21=32960
	;group_22=12583040
	;group_23=49280
	;group_24=64
	;group_25=16384
	;group_26=4194304
	;group_27=16448
	;group_28=4194368
	;group_29=4210688
	;group_30=4194368
	;group_31=4210688
	;col_mi_fade2_drawmode=150528
	;guideline_drawmode=180224
	;guideline_color=10067200
	;fadearea_drawmode=131072
	;fadearea_color=6291456
	;midi_selbg=16777215
	;col_tr1_divline=4342338
	;col_tr2_divline=4539717
	;col_envlane1_divline=7895154
	;col_envlane2_divline=7895154
	;col_main_resize=3355443
	;col_toolbar_text=10461087
	;col_arrangebg=4539717
	;midi_noteon_flash=64
	;mcp_fxparm_normal=10724259
	;mcp_fxparm_bypassed=4290771
	;mcp_fxparm_offlined=4013528
	;mcp_send_midihw=11590912
	;env_item_pitch=16776960
	;midi_selbg_drawmode=135169
	;toolbararmed_drawmode=196863
	;tcplocked_drawmode=180224
	;toolbararmed_color=9216020
	;tcplocked_color=3355443
	;selitem_tag=0
	;activetake_tag=0
	;midifont_col_dark=0
	;midifont_col_light=16777215
	;col_trans_fg=8553090
	;col_trans_bg=4802889
	;col_main_text2=7105644
	;col_main_bg2=3355443
	;col_transport_editbk=3355443
	;col_toolbar_text_on=10009626
	;col_toolbar_frame=5131847
	;col_vuind1=2105376
	;col_vuind2=10240
	;col_vuind3=65312
	;col_vuind4=65535
	;io_text=4671299
	;io_3dhl=8882049
	;io_3dsh=13487563
	;marqueezoom_fill=16777215
	;marqueezoom_outline=65280
	;marqueezoom_drawmode=147458
	;midieditorlist_bg=5526612
	;midieditorlist_fg=14737632
	;midieditorlist_grid=11645355
	;genlist_bg=14606044
	;genlist_fg=2829092
	;genlist_grid=11974319
	;windowtab_bg=3947580
	;genlist_selbg=6840646
	;genlist_selfg=16777215
	;genlist_seliabg=15790320
	;genlist_seliafg=0
	;midieditorlist_selbg=15790318
	;midieditorlist_selfg=2894890
	;midieditorlist_seliabg=15790320
	;midieditorlist_seliafg=0
	;col_peaksfade1=65280
	;col_peaksfade2=255
	;midieditorlist_bg2=11579562
	;midieditorlist_fg2=4605508
	;midieditorlist_selbg2=14277078
	;midieditorlist_selfg2=5066059
	;col_routinghl1=12648447
	;col_routinghl2=16744576
	;col_stretchmarker_h0=12829635
	;col_stretchmarker_h1=15505664
	;col_stretchmarker_h2=223
	;col_stretchmarker=12961221
	;col_stretchmarkerm=174080
	;col_stretchmarker_text=13882323
	;col_tl_fg2=6052956
	;col_stretchmarker_b=16777215
	;midi_selpitch1=6186050
	;midi_selpitch2=6515015
	;midi_trackbg_outer1=3355443
	;midi_trackbg_outer2=3552822
	;playrate_edited=11337472
	;docker_text_sel=1710618
	;col_stretchmarker_tm=59904
	;auto_item_unsel=6316128
	;timesig_sel_bg=160
	;arrange_vgrid=4605510
	;score_bg=16777215
	;score_fg=0
	;score_sel=16711680
	;score_timesel=14745599
	;score_loop=49407
	;group_32=16777088
	;group_33=8388736
	;group_34=8453889
	;group_35=16711808
	;group_36=16776961
	;group_37=8388609
	;group_38=14745472
	;group_39=8404864
	;group_40=8453920
	;group_41=14696320
	;group_42=14745376
	;group_43=8404768
	;group_44=12648320
	;group_45=8421248
	;group_46=8453952
	;group_47=12615552
	;group_48=12648256
	;group_49=8421184
	;group_50=14712704
	;group_51=8404800
	;group_52=8421152
	;group_53=14712704
	;group_54=12648224
	;group_55=12599168
	;group_56=10551168
	;group_57=8437632
	;group_58=8453984
	;group_59=10534784
	;group_60=10551136
	;group_61=8437600
	;group_62=10551136
	;group_63=8437600
	;cc_chase_drawmode=147456
	;wiring_grid=3355443
	;wiring_grid2=3026478
	;wiring_border=10066329
	;wiring_tbg=2500134
	;wiring_ticon=13421772
	;wiring_recbg=5066085
	;wiring_recitem=2171199
	;wiring_media=2113568
	;wiring_recv=6052956
	;wiring_send=6052956
	;wiring_hwout=4210752
	;wiring_recinput=4210816
	;wiring_horz_col=4737096
	;wiring_pin_normal=12632256
	;wiring_pin_connected=6328416
	;wiring_pin_disconnected=2105408
	;wiring_fader=12615808
	;wiring_parent=8421440
	;wiring_parentwire_border=6579300
	;wiring_parentwire_master=12632256
	;wiring_parentwire_folder=8421504
	;wiring_sendwire=8421504
	;wiring_hwoutwire=8421504
	;wiring_recinputwire=8421631
	;col_gridlines1dm=153856
	;col_gridlines2dm=180224
	;col_gridlines3dm=152576
	;midi_leftbg=11645355
	;midi_griddm1=138752
	;midi_griddm2=138752
	;midi_griddm3=144128
	;midi_gridh=0
	;midi_gridhc=0
	;midi_gridhdm=163840
	;midi_gridhcdm=196608
	;midi_ccbut=7303023
	;midi_itemctl2=0
	;midi_itemctl_mode=170240
	;midi_itemctl2_mode=163840
	;col_main_resize2=9216020
	;midifont_col_dark_unsel=0
	;midifont_col_light_unsel=16777215
	;midifont_mode=180224
	;midifont_mode_unsel=163840
	;col_explorer_seldm=157184
	;col_explorer_seledge=13224393
	;col_explorer_sel=16777215
	;[REAPER]
	;ui_img=Mnml
	;tl_font=F3FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E73205365726966000000000000000000000000A1
	;mi_font=F5FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E73205365726966000000000000000000000000A3
	;lb_font=F5FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E73205365726966000000000000000000000000A3
	;lb_font2=F3FFFFFF00000000000000000000000090010000000000000302012243616C696272690020446C67000000000000000000000000000000000000000096
	;trans_font=F3FFFFFF00000000000000000000000090010000000000000302012243616C69627269004C696768740000000000000000000000000000000000000057
	;user_font2=F3FFFFFF00000000000000000000000090010000000000000302012243616C69627269000000000000000000000000000000000000000000000000005F
	;user_font4=F3FFFFFF00000000000000000000000090010000000000000302012243616C696272690030365F3635000000000000000000000000000000000000008F
	;user_font5=F0FFFFFF00000000000000000000000090010000000000000302012243616C69627269000000000000000000000000000000000000000000000000005C
	;user_font6=EFFFFFFF00000000000000000000000090010000000000000302012243616C69627269000000000000000000000000000000000000000000000000005B
	;user_font7=ECFFFFFF00000000000000000000000090010000000000000302012243616C696272690000000000000000000000000000000000000000000000000058
	;user_font10=EBFFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E7320536572696600000000000000000000000099
	;user_font1=F4FFFFFF00000000000000000000000090010000000000000302012243616C696272690000000000000000000000000000000000000000000000000060
	;user_font3=F1FFFFFF00000000000000000000000090010000000000000302012243616C69627269004C696768740000000000000000000000000000000000000055
	;user_font12=E5FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E7320536572696600000000000000000000000093
	;user_font11=E8FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E7320536572696600000000000000000000000096
	;user_font8=FBFFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E73205365726966000000000000000000000000A9
	;user_font13=E3FFFFFF00000000000000000000000090010000000000000302012243616C6962726900742053616E7320536572696600000000000000000000000091
